[2025-09-22 16:29:33,341][INFO] ============================================================
[2025-09-22 16:29:33,341][INFO] Composition Training - FINAL FIXED VERSION
[2025-09-22 16:29:33,341][INFO] Model: 1L-1H-120D
[2025-09-22 16:29:33,341][INFO] Data: data/simple_graph/standardized_alpine_90_seed42
[2025-09-22 16:29:33,341][INFO] Train file: train_0.bin
[2025-09-22 16:29:33,341][INFO] Output dir: out/composition_d120_0mix_seed456_20250922_162933
[2025-09-22 16:29:33,341][INFO] ============================================================
[2025-09-22 16:29:33,345][INFO] Vocab size: 92, Block size: 32
[2025-09-22 16:29:33,977][INFO] Model initialized: 0.19M parameters
[2025-09-22 16:29:33,978][INFO] Starting training...
[2025-09-22 16:29:36,820][INFO] Iter     0 | Loss: train=nan, val=4.5988 | Acc: S1->S2=0.0%, S2->S3=0.0%, S1->S3=0.0%
[2025-09-22 16:29:44,317][INFO] Iter  1000 | Loss: train=1.9987, val=0.8796 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=88.0%
[2025-09-22 16:29:51,801][INFO] Iter  2000 | Loss: train=0.5832, val=0.9603 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=92.0%
[2025-09-22 16:29:59,271][INFO] Iter  3000 | Loss: train=0.5576, val=0.9513 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=88.0%
[2025-09-22 16:30:06,739][INFO] Iter  4000 | Loss: train=0.5468, val=1.0174 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:30:14,212][INFO] Iter  5000 | Loss: train=0.5409, val=1.0187 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:30:14,217][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_5000.pt
[2025-09-22 16:30:21,726][INFO] Iter  6000 | Loss: train=0.5366, val=0.9692 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:30:29,202][INFO] Iter  7000 | Loss: train=0.5339, val=0.9795 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:30:36,676][INFO] Iter  8000 | Loss: train=0.5320, val=1.0046 | Acc: S1->S2=100.0%, S2->S3=98.0%, S1->S3=82.0%
[2025-09-22 16:30:44,195][INFO] Iter  9000 | Loss: train=0.5300, val=0.9750 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:30:51,675][INFO] Iter 10000 | Loss: train=0.5288, val=1.0083 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=86.0%
[2025-09-22 16:30:51,680][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_10000.pt
[2025-09-22 16:30:59,166][INFO] Iter 11000 | Loss: train=0.5279, val=1.0127 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:31:06,695][INFO] Iter 12000 | Loss: train=0.5270, val=1.0170 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:31:14,161][INFO] Iter 13000 | Loss: train=0.5258, val=0.9776 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:31:21,627][INFO] Iter 14000 | Loss: train=0.5255, val=1.0194 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=76.0%
[2025-09-22 16:31:29,106][INFO] Iter 15000 | Loss: train=0.5239, val=1.0328 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:31:29,111][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_15000.pt
[2025-09-22 16:31:36,603][INFO] Iter 16000 | Loss: train=0.5252, val=1.0095 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=86.0%
[2025-09-22 16:31:44,090][INFO] Iter 17000 | Loss: train=0.5239, val=0.9921 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:31:51,578][INFO] Iter 18000 | Loss: train=0.5239, val=0.9780 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=78.0%
[2025-09-22 16:31:59,057][INFO] Iter 19000 | Loss: train=0.5225, val=1.0058 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:32:06,566][INFO] Iter 20000 | Loss: train=0.5237, val=1.0141 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=76.0%
[2025-09-22 16:32:06,571][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_20000.pt
[2025-09-22 16:32:14,094][INFO] Iter 21000 | Loss: train=0.5235, val=0.9788 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:32:21,614][INFO] Iter 22000 | Loss: train=0.5218, val=0.9957 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=76.0%
[2025-09-22 16:32:29,114][INFO] Iter 23000 | Loss: train=0.5231, val=0.9802 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:32:36,622][INFO] Iter 24000 | Loss: train=0.5213, val=1.0567 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:32:44,103][INFO] Iter 25000 | Loss: train=0.5221, val=1.0108 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=76.0%
[2025-09-22 16:32:44,108][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_25000.pt
[2025-09-22 16:32:51,594][INFO] Iter 26000 | Loss: train=0.5217, val=1.0229 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:32:59,083][INFO] Iter 27000 | Loss: train=0.5209, val=1.0150 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:33:06,566][INFO] Iter 28000 | Loss: train=0.5218, val=0.9833 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:33:14,070][INFO] Iter 29000 | Loss: train=0.5211, val=1.0434 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:33:21,544][INFO] Iter 30000 | Loss: train=0.5206, val=1.0323 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=78.0%
[2025-09-22 16:33:21,549][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_30000.pt
[2025-09-22 16:33:29,049][INFO] Iter 31000 | Loss: train=0.5207, val=1.0574 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:33:36,546][INFO] Iter 32000 | Loss: train=0.5218, val=1.0003 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:33:44,042][INFO] Iter 33000 | Loss: train=0.5209, val=0.9889 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:33:51,536][INFO] Iter 34000 | Loss: train=0.5210, val=1.0000 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:33:59,023][INFO] Iter 35000 | Loss: train=0.5203, val=1.0078 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:33:59,029][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_35000.pt
[2025-09-22 16:34:06,555][INFO] Iter 36000 | Loss: train=0.5201, val=1.0100 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:34:14,082][INFO] Iter 37000 | Loss: train=0.5213, val=1.0124 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:34:21,578][INFO] Iter 38000 | Loss: train=0.5206, val=1.0103 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:34:29,078][INFO] Iter 39000 | Loss: train=0.5206, val=1.0203 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=84.0%
[2025-09-22 16:34:36,586][INFO] Iter 40000 | Loss: train=0.5196, val=1.0057 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:34:36,591][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_40000.pt
[2025-09-22 16:34:44,097][INFO] Iter 41000 | Loss: train=0.5204, val=1.0249 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:34:51,613][INFO] Iter 42000 | Loss: train=0.5211, val=1.0007 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=78.0%
[2025-09-22 16:34:59,110][INFO] Iter 43000 | Loss: train=0.5206, val=1.0053 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=84.0%
[2025-09-22 16:35:06,624][INFO] Iter 44000 | Loss: train=0.5208, val=1.0591 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=84.0%
[2025-09-22 16:35:14,097][INFO] Iter 45000 | Loss: train=0.5205, val=1.0021 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=78.0%
[2025-09-22 16:35:14,102][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_45000.pt
[2025-09-22 16:35:21,608][INFO] Iter 46000 | Loss: train=0.5200, val=1.0605 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:35:29,091][INFO] Iter 47000 | Loss: train=0.5206, val=1.0045 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:35:36,577][INFO] Iter 48000 | Loss: train=0.5199, val=1.0080 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:35:44,034][INFO] Iter 49000 | Loss: train=0.5200, val=1.0201 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:35:51,515][INFO] Iter 50000 | Loss: train=0.5193, val=0.9953 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=78.0%
[2025-09-22 16:35:51,520][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_50000.pt
[2025-09-22 16:35:59,030][INFO] Iter 51000 | Loss: train=0.5201, val=1.0283 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:36:06,547][INFO] Iter 52000 | Loss: train=0.5197, val=1.0205 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:36:14,043][INFO] Iter 53000 | Loss: train=0.5202, val=1.0216 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=84.0%
[2025-09-22 16:36:21,524][INFO] Iter 54000 | Loss: train=0.5191, val=1.0243 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:36:29,011][INFO] Iter 55000 | Loss: train=0.5193, val=1.0309 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:36:29,016][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_55000.pt
[2025-09-22 16:36:36,513][INFO] Iter 56000 | Loss: train=0.5192, val=1.0429 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:36:44,024][INFO] Iter 57000 | Loss: train=0.5194, val=1.0248 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=74.0%
[2025-09-22 16:36:51,506][INFO] Iter 58000 | Loss: train=0.5187, val=1.0268 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:36:58,986][INFO] Iter 59000 | Loss: train=0.5188, val=1.0167 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:37:06,476][INFO] Iter 60000 | Loss: train=0.5202, val=0.9996 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:37:06,481][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_60000.pt
[2025-09-22 16:37:13,984][INFO] Iter 61000 | Loss: train=0.5197, val=1.0142 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:37:21,459][INFO] Iter 62000 | Loss: train=0.5194, val=1.0514 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:37:28,923][INFO] Iter 63000 | Loss: train=0.5197, val=1.0153 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:37:36,398][INFO] Iter 64000 | Loss: train=0.5199, val=1.0642 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:37:43,880][INFO] Iter 65000 | Loss: train=0.5194, val=1.0263 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:37:43,886][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_65000.pt
[2025-09-22 16:37:51,368][INFO] Iter 66000 | Loss: train=0.5188, val=1.0458 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:37:58,864][INFO] Iter 67000 | Loss: train=0.5191, val=1.0699 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:38:06,368][INFO] Iter 68000 | Loss: train=0.5194, val=1.0180 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:38:13,878][INFO] Iter 69000 | Loss: train=0.5196, val=1.0391 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=78.0%
[2025-09-22 16:38:21,362][INFO] Iter 70000 | Loss: train=0.5197, val=1.0117 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=78.0%
[2025-09-22 16:38:21,368][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_70000.pt
[2025-09-22 16:38:28,882][INFO] Iter 71000 | Loss: train=0.5197, val=1.0455 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:38:36,371][INFO] Iter 72000 | Loss: train=0.5194, val=1.0316 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:38:43,877][INFO] Iter 73000 | Loss: train=0.5192, val=1.0430 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:38:51,371][INFO] Iter 74000 | Loss: train=0.5199, val=1.0260 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=78.0%
[2025-09-22 16:38:58,869][INFO] Iter 75000 | Loss: train=0.5189, val=1.0422 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=84.0%
[2025-09-22 16:38:58,874][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_75000.pt
[2025-09-22 16:39:06,422][INFO] Iter 76000 | Loss: train=0.5196, val=1.0773 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:39:13,925][INFO] Iter 77000 | Loss: train=0.5183, val=1.0946 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:39:21,416][INFO] Iter 78000 | Loss: train=0.5187, val=1.0635 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:39:28,907][INFO] Iter 79000 | Loss: train=0.5192, val=1.0344 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:39:36,399][INFO] Iter 80000 | Loss: train=0.5190, val=1.0812 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:39:36,405][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_80000.pt
[2025-09-22 16:39:43,898][INFO] Iter 81000 | Loss: train=0.5192, val=1.0445 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:39:51,369][INFO] Iter 82000 | Loss: train=0.5190, val=1.0890 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=84.0%
[2025-09-22 16:39:58,857][INFO] Iter 83000 | Loss: train=0.5188, val=1.0549 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:40:06,342][INFO] Iter 84000 | Loss: train=0.5190, val=1.0549 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:40:13,864][INFO] Iter 85000 | Loss: train=0.5188, val=1.0435 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:40:13,871][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_85000.pt
[2025-09-22 16:40:21,391][INFO] Iter 86000 | Loss: train=0.5192, val=1.0362 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:40:28,902][INFO] Iter 87000 | Loss: train=0.5189, val=1.0415 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=84.0%
[2025-09-22 16:40:36,386][INFO] Iter 88000 | Loss: train=0.5189, val=1.0154 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:40:44,023][INFO] Iter 89000 | Loss: train=0.5191, val=1.0396 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=84.0%
[2025-09-22 16:40:51,510][INFO] Iter 90000 | Loss: train=0.5188, val=1.0615 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:40:51,514][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_90000.pt
[2025-09-22 16:40:59,030][INFO] Iter 91000 | Loss: train=0.5194, val=1.0709 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=84.0%
[2025-09-22 16:41:06,580][INFO] Iter 92000 | Loss: train=0.5188, val=1.0591 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:41:14,085][INFO] Iter 93000 | Loss: train=0.5193, val=1.0730 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:41:21,599][INFO] Iter 94000 | Loss: train=0.5179, val=1.0665 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=78.0%
[2025-09-22 16:41:29,070][INFO] Iter 95000 | Loss: train=0.5184, val=1.0000 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:41:29,076][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_95000.pt
[2025-09-22 16:41:36,565][INFO] Iter 96000 | Loss: train=0.5182, val=1.0185 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=84.0%
[2025-09-22 16:41:44,051][INFO] Iter 97000 | Loss: train=0.5187, val=1.0294 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=82.0%
[2025-09-22 16:41:51,531][INFO] Iter 98000 | Loss: train=0.5196, val=1.0354 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:41:59,023][INFO] Iter 99000 | Loss: train=0.5184, val=1.0635 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:42:06,585][INFO] Iter 100000 | Loss: train=0.5189, val=1.0599 | Acc: S1->S2=100.0%, S2->S3=100.0%, S1->S3=80.0%
[2025-09-22 16:42:06,591][INFO] Checkpoint saved to out/composition_d120_0mix_seed456_20250922_162933/ckpt_100000.pt
[2025-09-22 16:42:06,591][INFO] 
Training finished! Results are in: out/composition_d120_0mix_seed456_20250922_162933
